<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MDB Lutyen</title>
  <link rel="stylesheet" href="../../../styles.css" />
  <link rel="stylesheet" href="../../../JS/CSS/RequestStyle.css">
</head>

<body>
  <button class="close-btn" id="closeCard">‚Üê</button>
  <div class="main-container">
    <div class="image-container"></div>
  </div>
  <!-- Bottom Center Panel -->
  <nav class="jumpbar" role="navigation" aria-label="Quick jumps">
    <div class="jumpbar-inner">
      <button class="jumpchip is-accent" id="playWalkthroughBtn">üé• Walkthrough</button>
      <button class="jumpchip" onclick="location.href='../Lobby_Top.html'">MAP</button>
      <button class="jumpchip" onclick="location.href='Kitchen.html'">Kitchen</button>
      <button class="jumpchip" onclick="location.href='Lobby.html'">Lobby</button>
      <button class="jumpchip" onclick="location.href='Room_1.html'">Room 1</button>
      <button class="jumpchip" onclick="location.href='Room_2.html'">Room 2</button>
      <button class="jumpchip" onclick="location.href='Dinning.html'">Dinning Table</button>
      <button class="jumpchip is-accent" id="playWalkthroughBtn">Request Call Back</button>
      <!-- add more as you like -->
    </div>
  </nav>
  <div id="videoOverlay" class="video-overlay">
    <video id="walkthroughVideo" controls preload="none">
      <source src="../../../Video/Lutyen Lobby.webm" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </div>
  <div class="callback-enquiry">
    <div class="callback-overlay" id="callbackOverlay" aria-hidden="true">
      <div class="callback-modal" role="dialog" aria-labelledby="callbackTitle">
        <div class="callback-modal-header">
          <div id="callbackTitle" class="callback-title">Request Callback</div>
          <button class="callback-close" id="callbackCloseBtn" aria-label="Close">‚úï</button>
        </div>

        <div class="callback-modal-body">
          <form id="callbackForm" class="callback-form" novalidate>
            <div class="callback-two">
              <input class="callback-input" name="firstName" placeholder="First Name" required />
              <input class="callback-input" name="lastName" placeholder="Last Name" required />
            </div>

            <div class="callback-phone">
              <select name="dialCode" aria-label="Country Code">
                <option>+91</option>
                <option>+971</option>
                <option>+44</option>
                <option>+1</option>
              </select>
              <input type="tel" name="phone" placeholder="Phone Number" required />
            </div>

            <input class="callback-input" type="email" name="email" placeholder="Email Address" required />

            <label class="callback-agree">
              <input type="checkbox" id="callbackAgree" />
              <span>I agree to the <a href="#">Privacy Policy</a> and
                <a href="#">Terms & Conditions</a>.</span>
            </label>

            <button class="callback-submit" type="submit">Submit</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/105/three.min.js"
    integrity="sha512-uWKImujbh9CwNa8Eey5s8vlHDB4o1HhrVszkympkm5ciYTnUEQv3t4QHU02CUqPtdKTg62FsHo12x63q6u0wmg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="../../../JS/panolens.min.js"></script>

  <!-- <script>const panoramaImage = new PANOLENS.ImagePanorama("../../../images/Apparments/3BHK/360/Room_3.jpg"); -->
  <script>
    // 1) Define both images (put both in /images/360/)
    const LOW_SRC = "../../../images/Thumbnail/Apartments/3BHK/360/Room_3.webp"; // lightweight preview
    const HIGH_SRC = "../../../images/Apartments/3BHK/360/Room_3.jpg";      // full quality

    const imageContainer = document.querySelector(".image-container");

    // 2) Create panoramas
    const panoLow = new PANOLENS.ImagePanorama(LOW_SRC);
    const panoHigh = new PANOLENS.ImagePanorama(HIGH_SRC);

    // 3) Viewer
    const viewer = new PANOLENS.Viewer({
      container: imageContainer,
      autoRotate: false,
      autoRotateSpeed: 0.1,
      controlBar: false,
      cameraFov: 70
    });
    // after: const viewer = new PANOLENS.Viewer({...});
    let didInitView = false;


    // Keep the same initial yaw on both (texture yaw)
    const TEXTURE_YAW = -Math.PI / 2 + 0; // your existing value
    panoLow.rotation.y = TEXTURE_YAW;
    panoHigh.rotation.y = TEXTURE_YAW;

    // Desired tilt DOWN amount (pitch)
    const TILT_DOWN = Math.PI / 50; // ~16¬∞

    function setInitialViewAndLockPitch() {
      if (didInitView) return;   // ‚úÖ run only once (prevents flicker on swap)
      didInitView = true;

      const controls = viewer.getControl();

      // Positive value here, we pass -TILT to tilt DOWN
      const TILT = -Math.PI / 40;     // adjust how much you want to tilt
      controls.rotateUp(-TILT);      // tilt down

      // No vertical limits (free up/down)
      if ('minPolarAngle' in controls && 'maxPolarAngle' in controls) {
        controls.minPolarAngle = 0;          // can look straight up
        controls.maxPolarAngle = Math.PI;    // can look straight down
      }

      // Optional: rotation only (no panning)
      if ('enablePan' in controls) controls.enablePan = false;
    }


    // Apply same camera view when each pano becomes active
    panoLow.addEventListener('enter', setInitialViewAndLockPitch);
    panoHigh.addEventListener('enter', setInitialViewAndLockPitch);

    // Start with low; add both to viewer for smooth swap
    viewer.add(panoLow);
    viewer.add(panoHigh);
    viewer.setPanorama(panoLow);

    // Preload + swap high-res when ready
    panoLow.addEventListener("load", () => {
      panoHigh.addEventListener("load", () => {
        viewer.setPanorama(panoHigh, 600); // fade swap
        console.log("‚úÖ Swapped to high-res panorama");
      });
      panoHigh.load();
    });

    panoHigh.addEventListener("error", (e) => {
      console.warn("‚ö†Ô∏è Failed to load high-res:", e);
    });
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const closeCard = document.getElementById("closeCard");

      if (closeCard) {
        closeCard.addEventListener("click", () => {
          // üîπ Change this path to wherever you want the button to take you
          window.location.href = "../../../SubPages/3BHK/Lobby_Top.html";
          // Example: "../index.html" or "../SubPages/Tower_A.html"
        });
      }
    });
  </script>
  <script src="../../../JS/TM_Requestbtn.js"></script>
  <script src="../../../JS/VideoPlayer.js"></script>
  <script src="../../../JS/Disbale-Inspect.js"></script>
  <script src="../../../JS/Image_Loader.js"></script>
</body>

</html>